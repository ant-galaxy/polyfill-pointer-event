!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@oasisEngine/pointerPolyfill"]={})}(this,(function(e){"use strict";function t(e){return t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(e)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,t,c){return r=n()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var c=new(Function.bind.apply(e,r));return n&&o(c,n.prototype),c},r.apply(null,arguments)}function c(e){var n="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(c=e,-1===Function.toString.call(c).indexOf("[native code]")))return e;var c;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,u)}function u(){return r(e,arguments,t(this).constructor)}return u.prototype=Object.create(e.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),o(u,e)},c(e)}var u=function(e){var t,n;function r(t){var o;return(o=e.call(this,t)||this).pointerType=void 0,o.pointerId=void 0,o.offsetX=void 0,o.offsetY=void 0,o}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n),r.createFromTouch=function(e,t){var o=new r(e);return o.pointerType="touch",o.pointerId=(t.identifier||0)+2,o.offsetX=t.pageX-i.canvas.offsetLeft,o.offsetY=t.pageY-i.canvas.offsetTop,o},r}(c(Event)),i=function(){function e(){}return e.register=function(t){if(window.PointerEvent)console.info("支持 PointerEvent ");else{if(e.canvas){if(e.canvas===t)return void console.info("已经注册了画布",t);e.unregister()}e.canvas=t,t.addEventListener("touchstart",e.onTouchStart),t.addEventListener("touchmove",e.onTouchMove),t.addEventListener("touchend",e.onTouchEnd),t.addEventListener("touchcancel",e.onTouchCancel)}},e.unregister=function(){if(e.canvas){var t=e.canvas;t.removeEventListener("touchstart",e.onTouchStart),t.removeEventListener("touchmove",e.onTouchMove),t.removeEventListener("touchend",e.onTouchEnd),t.removeEventListener("touchcancel",e.onTouchCancel),e.canvas=null}},e.onTouchStart=function(t){var o=e.canvas;if(o)for(var n=t.changedTouches||t.touches,r=0;r<n.length;r++)o.onpointerdown(u.createFromTouch("pointerdown",n[r]))},e.onTouchEnd=function(t){var o=e.canvas;if(o)for(var n=t.changedTouches||t.touches,r=0;r<n.length;r++){var c=n[r];o.onpointerup(u.createFromTouch("pointerup",c)),o.onpointerout(u.createFromTouch("pointerout",c))}},e.onTouchMove=function(t){var o=e.canvas;if(o)for(var n=t.changedTouches||t.touches,r=0;r<n.length;r++)o.onpointermove(u.createFromTouch("pointermove",n[r]))},e.onTouchCancel=function(t){var o=e.canvas;if(o)for(var n=t.changedTouches||t.touches,r=0;r<n.length;r++)o.onpointerout(u.createFromTouch("pointerout",n[r]))},e}();i.canvas=void 0,e.PointerPolyfill=i,Object.defineProperty(e,"__esModule",{value:!0})}));
